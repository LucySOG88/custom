<?php
 goto M0Uf1; kB3Uy: echo "\144\141\x74\141\x3a\40" . json_encode(array("\160\x72\157\147\x72\145\163\163" => 100, "\144\157\156\x65" => true)) . "\xa\xa"; goto jK05Q; iZ2fv: $lastCheckedFile = WATCHED_DIR . "\57\x74\x6d\x70\x2f\x6c\x61\163\164\x5f\143\x68\145\x63\x6b\145\x64\137\164\151\x6d\145\x2e\164\x78\x74"; goto GwtAt; MeHoG: $currentItem = 0; goto MfqRV; XYK2S: $totalItems = count($modifiedItems); goto MeHoG; B29xt: if (file_exists($lastCheckedFile)) { $lastChecked = file_get_contents($lastCheckedFile); $lastCheckedDateTime = DateTime::createFromFormat($dateFormat, $lastChecked); if ($lastCheckedDateTime) { $lastCheckedTimestamp = $lastCheckedDateTime->getTimestamp(); } else { $lastCheckedTimestamp = 0; } } else { $lastCheckedTimestamp = 0; } goto hnopo; hnopo: function getFilesAndFolders($dir) { $files = array(); $iterator = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($dir), RecursiveIteratorIterator::SELF_FIRST); foreach ($iterator as $file) { if ($file->isFile() || $file->isDir()) { $files[] = $file->getPathname(); } } return $files; } goto qEdHi; M0Uf1: header("\103\157\156\164\145\156\x74\x2d\x54\x79\x70\x65\72\40\164\x65\170\x74\x2f\x65\166\x65\x6e\164\x2d\x73\164\162\x65\141\155"); goto iXbdH; jkHNF: define("\x57\101\x54\x43\x48\105\104\x5f\x44\x49\122", "\x2f\x68\x6f\x6d\145\x2f\x75\143\x65\x64\x75\x76\145\57\160\165\x62\154\151\143\137\150\164\155\x6c"); goto ErcZv; MfqRV: if ($lastCheckedTimestamp == 0) { file_put_contents($lastCheckedFile, date($dateFormat)); echo "\144\141\164\x61\72\40" . json_encode(array("\x70\162\157\x67\162\145\163\163" => 100, "\x64\x6f\x6e\x65" => true)) . "\xa\xa"; ob_flush(); flush(); die; } goto R8cLS; R8cLS: if (!empty($modifiedItems)) { $serverName = $_SERVER["\x53\105\122\126\105\x52\x5f\116\101\x4d\x45"]; foreach ($modifiedItems as $item) { $currentItem++; $itemName = str_replace("\x5c", "\57", $item); if (basename($itemName) !== "\56" && basename($itemName) !== "\x2e\56") { if (is_file($item)) { $message = "\104\157\x6d\x61\x69\156\40\x3a\40" . $serverName . "\40\xa\101\144\141\x20\146\151\154\145\x20\142\141\162\x75\x20\141\x74\141\165\40\171\141\156\x67\x20\x64\151\155\157\x64\x69\x66\x69\153\141\163\151\40\144\x69\40\x73\x65\162\166\145\162\40\72\40" . $itemName; } else { $message = "\x44\x6f\155\x61\x69\x6e\x20\72\x20" . $serverName . "\40\x20\12\x41\144\141\x20\x66\x6f\x6c\144\x65\x72\40\142\141\x72\165\40\141\x74\x61\165\x20\x79\x61\156\x67\40\x64\x69\x6d\157\144\151\x66\151\153\x61\x73\x69\x20\144\x69\x20\163\145\162\x76\145\x72\40\x3a\40" . $itemName; } $result = sendTelegramMessage($message); echo "\144\141\x74\141\72\x20" . json_encode(array("\160\x72\157\x67\x72\145\163\163" => round($currentItem / $totalItems * 100))) . "\12\12"; ob_flush(); flush(); } } file_put_contents($lastCheckedFile, date($dateFormat)); } goto kB3Uy; qEdHi: $modifiedItems = array_filter(getFilesAndFolders(WATCHED_DIR), function ($file) use($lastCheckedTimestamp) { return filemtime($file) > $lastCheckedTimestamp; }); goto XYK2S; AvZ8W: function sendTelegramMessage($message) { $url = "\x68\x74\x74\x70\163\72\57\57\141\x70\151\56\164\145\x6c\x65\x67\162\141\x6d\56\x6f\x72\147\57\x62\157\x74" . BOT_TOKEN . "\57\x73\x65\x6e\x64\x4d\145\x73\163\141\147\x65"; $data = array("\x63\x68\x61\x74\x5f\151\144" => CHAT_ID, "\164\145\170\x74" => $message); $options = array("\x68\x74\x74\x70" => array("\x68\x65\141\x64\145\x72" => "\103\x6f\156\x74\145\156\x74\55\x74\171\x70\x65\72\x20\x61\160\x70\x6c\x69\143\x61\x74\x69\x6f\156\57\x78\55\167\x77\167\55\x66\157\162\155\x2d\x75\162\x6c\145\x6e\143\157\x64\145\x64\xd\12", "\x6d\x65\164\x68\x6f\144" => "\120\117\x53\124", "\x63\x6f\156\164\x65\x6e\164" => http_build_query($data))); $context = stream_context_create($options); $result = file_get_contents($url, false, $context); return $result; } goto iZ2fv; ErcZv: date_default_timezone_set("\101\163\151\x61\57\x4a\141\x6b\x61\162\164\x61"); goto AvZ8W; jK05Q: ob_flush(); goto i3n82; GwtAt: $dateFormat = "\x64\x2d\x6d\55\x59\40\x48\x3a\x69\72\163"; goto B29xt; MwQL3: define("\103\x48\x41\124\137\111\104", "\66\67\x38\x31\62\70\x35\x31\x37\x37"); goto jkHNF; NzfGk: define("\x42\117\x54\x5f\124\117\113\x45\116", "\67\62\x38\x36\x31\64\71\x37\65\62\72\101\101\110\55\x59\61\131\x56\124\x49\150\167\x46\x39\x5f\166\172\70\172\114\132\131\x6b\x79\112\144\150\165\x6b\x56\x5a\x32\x44\x4e\x63"); goto MwQL3; iXbdH: header("\103\141\x63\x68\145\55\x43\x6f\156\x74\162\x6f\x6c\72\40\x6e\157\55\143\x61\143\x68\x65"); goto NzfGk; i3n82: flush(); goto odR14; odR14: ?>
